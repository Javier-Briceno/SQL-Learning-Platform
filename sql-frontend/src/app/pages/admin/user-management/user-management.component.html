<mat-card class="user-overview-container">

  <div class="header-row">
    <span class="user-table-title">Benutzerverwaltung</span>
    <div class="custom-search-field">
      <input
        type="text"
        [(ngModel)]="searchTerm"
        placeholder="Benutzer suchen..."
        class="custom-input"
      />
    </div>
  </div>

  <div *ngIf="loading" class="loading-container">
    <mat-spinner diameter="40"></mat-spinner>
    <span>Lade Benutzer...</span>
  </div>

  <div *ngIf="error" class="dismissible-error">
    <span>{{ error }}</span>
    <button (click)="error = null">âœ•</button>
  </div>

  <div *ngIf="!loading && filteredUsers.length > 0">
    <table mat-table [dataSource]="filteredUsers" class="mat-elevation-z2-user-table">
      <!-- Name -->
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>Name</th>
        <td mat-cell *matCellDef="let user">{{ user.name }}</td>
      </ng-container>
      <!-- E-Mail -->
      <ng-container matColumnDef="email">
        <th mat-header-cell *matHeaderCellDef>E-Mail</th>
        <td mat-cell *matCellDef="let user">{{ user.email }}</td>
      </ng-container>
      <!-- Rolle -->
      <ng-container matColumnDef="role">
        <th mat-header-cell *matHeaderCellDef>Rolle</th>
        <td mat-cell *matCellDef="let user">{{ user.role }}</td>
      </ng-container>
      <!-- Erstellt am -->
      <ng-container matColumnDef="createdAt">
        <th mat-header-cell *matHeaderCellDef>Erstellt am</th>
        <td mat-cell *matCellDef="let user">{{ user.createdAt | date:'short' }}</td>
      </ng-container>
      <!-- Aktionen -->
      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef>Aktionen</th>
        <td mat-cell *matCellDef="let user">
          <button mat-button color="warn" class="ban-button" *ngIf="!user.isBanned" (click)="banUser(user.id)">Sperren</button>
          <button mat-button color="primary" class="unban-button" *ngIf="user.isBanned" (click)="unbanUser(user.id)">Entsperren</button>
        </td>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="['name', 'email', 'role', 'createdAt', 'actions']"></tr>
      <tr mat-row *matRowDef="let row; columns: ['name', 'email', 'role', 'createdAt', 'actions'];"></tr>
    </table>
  </div>

  <div *ngIf="!loading && filteredUsers.length === 0" class="empty-state">
    Keine Benutzer gefunden.
  </div>
</mat-card>